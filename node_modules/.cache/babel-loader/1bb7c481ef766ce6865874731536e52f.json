{"ast":null,"code":"const _floatView = new Float32Array(1);\n\nconst _int32View = new Int32Array(_floatView.buffer);\n\nclass DataUtils {\n  // Converts float32 to float16 (stored as uint16 value).\n  static toHalfFloat(val) {\n    if (val > 65504) {\n      console.warn('THREE.DataUtils.toHalfFloat(): value exceeds 65504.');\n      val = 65504; // maximum representable value in float16\n    } // Source: http://gamedev.stackexchange.com/questions/17326/conversion-of-a-number-from-single-precision-floating-point-representation-to-a/17410#17410\n\n    /* This method is faster than the OpenEXR implementation (very often\n    * used, eg. in Ogre), with the additional benefit of rounding, inspired\n    * by James Tursa?s half-precision code. */\n\n\n    _floatView[0] = val;\n    const x = _int32View[0];\n    let bits = x >> 16 & 0x8000;\n    /* Get the sign */\n\n    let m = x >> 12 & 0x07ff;\n    /* Keep one extra bit for rounding */\n\n    const e = x >> 23 & 0xff;\n    /* Using int is faster here */\n\n    /* If zero, or denormal, or exponent underflows too much for a denormal\n    \t* half, return signed zero. */\n\n    if (e < 103) return bits;\n    /* If NaN, return NaN. If Inf or exponent overflow, return Inf. */\n\n    if (e > 142) {\n      bits |= 0x7c00;\n      /* If exponent was 0xff and one mantissa bit was set, it means NaN,\n      \t\t\t* not Inf, so make sure we set one mantissa bit too. */\n\n      bits |= (e == 255 ? 0 : 1) && x & 0x007fffff;\n      return bits;\n    }\n    /* If exponent underflows but not too much, return a denormal */\n\n\n    if (e < 113) {\n      m |= 0x0800;\n      /* Extra rounding may overflow and set mantissa to 0 and exponent\n      \t* to 1, which is OK. */\n\n      bits |= (m >> 114 - e) + (m >> 113 - e & 1);\n      return bits;\n    }\n\n    bits |= e - 112 << 10 | m >> 1;\n    /* Extra rounding. An overflow will set mantissa to 0 and increment\n    \t* the exponent, which is OK. */\n\n    bits += m & 1;\n    return bits;\n  }\n\n}\n\nexport { DataUtils };","map":null,"metadata":{},"sourceType":"module"}