{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/robertrinearson/Documents/blockchain/lfg/cyberdeck-twitter/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _slicedToArray from \"/Users/robertrinearson/Documents/blockchain/lfg/cyberdeck-twitter/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/Users/robertrinearson/Documents/blockchain/lfg/cyberdeck-twitter/node_modules/@babel/runtime/regenerator/index.js\";\n\nfunction e(e, r, n, t) {\n  return new (n || (n = Promise))(function (o, a) {\n    function i(e) {\n      try {\n        c(t.next(e));\n      } catch (e) {\n        a(e);\n      }\n    }\n\n    function d(e) {\n      try {\n        c(t.throw(e));\n      } catch (e) {\n        a(e);\n      }\n    }\n\n    function c(e) {\n      var r;\n      e.done ? o(e.value) : (r = e.value, r instanceof n ? r : new n(function (e) {\n        e(r);\n      })).then(i, d);\n    }\n\n    c((t = t.apply(e, r || [])).next());\n  });\n}\n\nvar r = [\"geforce 320m\", \"geforce 8600\", \"geforce 8600m gt\", \"geforce 8800 gs\", \"geforce 8800 gt\", \"geforce 9400\", \"geforce 9400m g\", \"geforce 9400m\", \"geforce 9600m gt\", \"geforce 9600m\", \"geforce fx go5200\", \"geforce gt 120\", \"geforce gt 130\", \"geforce gt 330m\", \"geforce gtx 285\", \"google swiftshader\", \"intel g41\", \"intel g45\", \"intel gma 4500mhd\", \"intel gma x3100\", \"intel hd 3000\", \"intel q45\", \"legacy\", \"mali-2\", \"mali-3\", \"mali-4\", \"quadro fx 1500\", \"quadro fx 4\", \"quadro fx 5\", \"radeon hd 2400\", \"radeon hd 2600\", \"radeon hd 4670\", \"radeon hd 4850\", \"radeon hd 4870\", \"radeon hd 5670\", \"radeon hd 5750\", \"radeon hd 6290\", \"radeon hd 6300\", \"radeon hd 6310\", \"radeon hd 6320\", \"radeon hd 6490m\", \"radeon hd 6630m\", \"radeon hd 6750m\", \"radeon hd 6770m\", \"radeon hd 6970m\", \"radeon r9 200\", \"sgx 543\", \"sgx543\"],\n    n = function n(e) {\n  return e = e.toLowerCase().replace(/^angle ?\\((.+)\\)*$/, \"$1\").replace(/\\s(\\d{1,2}gb|direct3d.+$)|\\(r\\)| \\([^)]+\\)$/g, \"\");\n},\n    t = \"undefined\" == typeof window,\n    o = function () {\n  if (t) return;\n  var _window$navigator = window.navigator,\n      e = _window$navigator.userAgent,\n      r = _window$navigator.platform,\n      n = _window$navigator.maxTouchPoints,\n      o = /(iphone|ipod|ipad)/i.test(e),\n      a = \"iPad\" === r || \"MacIntel\" === r && n > 0 && !window.MSStream;\n  return {\n    isIpad: a,\n    isMobile: /android/i.test(e) || o || a,\n    isSafari12: /Version\\/12.+Safari/.test(e)\n  };\n}(),\n    a = function a(e, r, n) {\n  return \"apple gpu\" === r ? function (e, r, n) {\n    var t = [r];\n\n    if (n) {\n      var _r = \"\\n      precision highp float;\\n      attribute vec3 aPosition;\\n      varying float vvv;\\n      void main() {\\n        vvv = 0.31622776601683794;\\n        gl_Position = vec4(aPosition, 1.0);\\n      }\\n    \",\n          _n = \"\\n      precision highp float;\\n      varying float vvv;\\n      void main() {\\n        vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\\n        enc = fract(enc);\\n        enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\\n        gl_FragColor = enc;\\n      }\\n    \",\n          _a = e.createShader(35633),\n          _i = e.createShader(35632),\n          _d = e.createProgram();\n\n      if (_i && _a && _d) {\n        e.shaderSource(_a, _r), e.shaderSource(_i, _n), e.compileShader(_a), e.compileShader(_i), e.attachShader(_d, _a), e.attachShader(_d, _i), e.linkProgram(_d), e.detachShader(_d, _a), e.detachShader(_d, _i), e.deleteShader(_a), e.deleteShader(_i), e.useProgram(_d);\n\n        var _c = e.createBuffer();\n\n        e.bindBuffer(34962, _c), e.bufferData(34962, new Float32Array([-1, -1, 0, 3, -1, 0, -1, 3, 0]), 35044);\n\n        var _l = e.getAttribLocation(_d, \"aPosition\");\n\n        e.vertexAttribPointer(_l, 3, 5126, !1, 0, 0), e.enableVertexAttribArray(_l), e.clearColor(1, 1, 1, 1), e.clear(16384), e.viewport(0, 0, 1, 1), e.drawArrays(4, 0, 3);\n        var f = new Uint8Array(4);\n        e.readPixels(0, 0, 1, 1, 6408, 5121, f), e.deleteProgram(_d), e.deleteBuffer(_c), t = {\n          801621810: (null == o ? void 0 : o.isIpad) ? [\"apple a12x gpu\"] : [\"apple a11 gpu\", \"apple a12 gpu\", \"apple a13 gpu\", \"apple a14 gpu\"],\n          8016218135: (null == o ? void 0 : o.isIpad) ? [\"apple a9x gpu\", \"apple a10 gpu\", \"apple a10x gpu\"] : [\"apple a9 gpu\", \"apple a10 gpu\"]\n        }[f.join(\"\")] || t;\n      }\n    }\n\n    return t;\n  }(e, r, n) : [r];\n},\n    i = [],\n    d = [],\n    c = function c(e, r) {\n  if (e === r) return 0;\n  var n = e;\n  e.length > r.length && (e = r, r = n);\n  var t = e.length,\n      o = r.length;\n\n  for (; t > 0 && e.charCodeAt(~-t) === r.charCodeAt(~-o);) {\n    t--, o--;\n  }\n\n  var a,\n      c = 0;\n\n  for (; c < t && e.charCodeAt(c) === r.charCodeAt(c);) {\n    c++;\n  }\n\n  if (t -= c, o -= c, 0 === t) return o;\n  var l,\n      f,\n      s = 0,\n      g = 0,\n      p = 0;\n\n  for (; g < t;) {\n    d[g] = e.charCodeAt(c + g), i[g] = ++g;\n  }\n\n  for (; p < o;) {\n    for (a = r.charCodeAt(c + p), l = p++, s = p, g = 0; g < t; g++) {\n      f = a === d[g] ? l : l + 1, l = i[g], s = i[g] = l > s ? f > s ? s + 1 : f : f > l ? l + 1 : f;\n    }\n  }\n\n  return s;\n},\n    l = function l() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$mobileTiers = _ref.mobileTiers,\n      i = _ref$mobileTiers === void 0 ? [0, 15, 30, 60] : _ref$mobileTiers,\n      _ref$desktopTiers = _ref.desktopTiers,\n      d = _ref$desktopTiers === void 0 ? [0, 15, 30, 60] : _ref$desktopTiers,\n      _ref$override = _ref.override,\n      l = _ref$override === void 0 ? {} : _ref$override,\n      f = _ref.glContext,\n      _ref$failIfMajorPerfo = _ref.failIfMajorPerformanceCaveat,\n      s = _ref$failIfMajorPerfo === void 0 ? !1 : _ref$failIfMajorPerfo,\n      _ref$benchmarksURL = _ref.benchmarksURL,\n      g = _ref$benchmarksURL === void 0 ? \"https://unpkg.com/detect-gpu@3.1.30/dist/benchmarks\" : _ref$benchmarksURL;\n\n  return e(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var p, _l$isIpad, u, _l$isMobile, h, _l$screenSize, v, _l$loadBenchmarks, m, w, A, x, S, _e, _r2, b, _e4, _b$sort$, P, C, y, L, E, _e5;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            p = {};\n\n            if (!t) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", {\n              tier: 0,\n              type: \"SSR\"\n            });\n\n          case 3:\n            _l$isIpad = l.isIpad, u = _l$isIpad === void 0 ? !!(null == o ? void 0 : o.isIpad) : _l$isIpad, _l$isMobile = l.isMobile, h = _l$isMobile === void 0 ? !!(null == o ? void 0 : o.isMobile) : _l$isMobile, _l$screenSize = l.screenSize, v = _l$screenSize === void 0 ? window.screen : _l$screenSize, _l$loadBenchmarks = l.loadBenchmarks, m = _l$loadBenchmarks === void 0 ? function (r) {\n              return e(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                var e;\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return fetch(\"\".concat(g, \"/\").concat(r)).then(function (e) {\n                          return e.json();\n                        });\n\n                      case 2:\n                        e = _context.sent;\n                        return _context.abrupt(\"return\", (e.shift(), e));\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n            } : _l$loadBenchmarks;\n            w = l.renderer;\n\n            A = function A(e, r, n, t, o) {\n              return {\n                device: o,\n                fps: t,\n                gpu: n,\n                isMobile: h,\n                tier: e,\n                type: r\n              };\n            };\n\n            S = \"\";\n\n            if (!w) {\n              _context3.next = 11;\n              break;\n            }\n\n            w = n(w), x = [w];\n            _context3.next = 18;\n            break;\n\n          case 11:\n            _e = f || function (e) {\n              var r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n              var n = {\n                alpha: !1,\n                antialias: !1,\n                depth: !1,\n                failIfMajorPerformanceCaveat: r,\n                powerPreference: \"high-performance\",\n                stencil: !1\n              };\n              e && delete n.powerPreference;\n              var t = window.document.createElement(\"canvas\"),\n                  o = t.getContext(\"webgl\", n) || t.getContext(\"experimental-webgl\", n);\n              return null != o ? o : void 0;\n            }(null == o ? void 0 : o.isSafari12, s);\n\n            if (_e) {\n              _context3.next = 14;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", A(0, \"WEBGL_UNSUPPORTED\"));\n\n          case 14:\n            _r2 = _e.getExtension(\"WEBGL_debug_renderer_info\");\n\n            if (!(_r2 && (w = _e.getParameter(_r2.UNMASKED_RENDERER_WEBGL)), !w)) {\n              _context3.next = 17;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", A(1, \"FALLBACK\"));\n\n          case 17:\n            S = w, w = n(w), x = a(_e, w, h);\n\n          case 18:\n            _context3.next = 20;\n            return Promise.all(x.map(function (r) {\n              return e(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var e, n, t, o, a, i, d, l, f, _ref6, _ref7, s, g, w, _window, A, x, _iterator, _step, _e2, _e3, _r4, _n3, _t, _o, _f, _f2, S, b;\n\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        e = function (e) {\n                          var r = h ? [\"adreno\", \"apple\", \"mali-t\", \"mali\", \"nvidia\", \"powervr\"] : [\"intel\", \"amd\", \"radeon\", \"nvidia\", \"geforce\"];\n\n                          for (var _i2 = 0, _r3 = r; _i2 < _r3.length; _i2++) {\n                            var _n2 = _r3[_i2];\n                            if (e.includes(_n2)) return _n2;\n                          }\n                        }(r);\n\n                        if (e) {\n                          _context2.next = 3;\n                          break;\n                        }\n\n                        return _context2.abrupt(\"return\");\n\n                      case 3:\n                        n = \"\".concat(h ? \"m\" : \"d\", \"-\").concat(e, \".json\"), t = p[n] = p[n] || m(n);\n                        _context2.prev = 4;\n                        _context2.next = 7;\n                        return t;\n\n                      case 7:\n                        o = _context2.sent;\n                        _context2.next = 13;\n                        break;\n\n                      case 10:\n                        _context2.prev = 10;\n                        _context2.t0 = _context2[\"catch\"](4);\n                        return _context2.abrupt(\"return\");\n\n                      case 13:\n                        a = function (e) {\n                          var r;\n                          var n = (e = e.replace(/\\([^)]+\\)/, \"\")).match(/\\d+/) || e.match(/(\\W|^)([A-Za-z]{1,3})(\\W|$)/g);\n                          return null !== (r = null == n ? void 0 : n.join(\"\").replace(/\\W|amd/g, \"\")) && void 0 !== r ? r : \"\";\n                        }(r), i = \"apple\" === e;\n                        d = o.filter(function (_ref2) {\n                          var _ref3 = _slicedToArray(_ref2, 2),\n                              e = _ref3[1];\n\n                          return e === a;\n                        });\n                        d.length || (d = o.filter(function (_ref4) {\n                          var _ref5 = _slicedToArray(_ref4, 1),\n                              e = _ref5[0];\n\n                          return e.includes(r);\n                        }));\n                        l = d.length;\n\n                        if (!(0 === l)) {\n                          _context2.next = 19;\n                          break;\n                        }\n\n                        return _context2.abrupt(\"return\");\n\n                      case 19:\n                        _ref6 = l > 1 ? d.map(function (e) {\n                          return [e, c(r, e[0])];\n                        }).sort(function (_ref8, _ref9) {\n                          var _ref10 = _slicedToArray(_ref8, 2),\n                              e = _ref10[1];\n\n                          var _ref11 = _slicedToArray(_ref9, 2),\n                              r = _ref11[1];\n\n                          return e - r;\n                        })[0][0] : d[0], _ref7 = _slicedToArray(_ref6, 4), s = _ref7[0], g = _ref7[3], w = Number.MAX_VALUE;\n                        _window = window, A = _window.devicePixelRatio, x = v.width * A * (v.height * A);\n                        i && h && (g = g.filter(function (_ref12) {\n                          var _ref13 = _slicedToArray(_ref12, 4),\n                              e = _ref13[3];\n\n                          var r;\n                          return (null !== (r = null == e ? void 0 : e.indexOf(u ? \"ipad\" : \"iphone\")) && void 0 !== r ? r : -1) > -1;\n                        }));\n                        _iterator = _createForOfIteratorHelper(g);\n\n                        try {\n                          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                            _e2 = _step.value;\n                            _e3 = _slicedToArray(_e2, 2), _r4 = _e3[0], _n3 = _e3[1], _t = _r4 * _n3, _o = Math.abs(x - _t);\n                            _o < w && (w = _o, f = _e2);\n                          }\n                        } catch (err) {\n                          _iterator.e(err);\n                        } finally {\n                          _iterator.f();\n                        }\n\n                        if (f) {\n                          _context2.next = 26;\n                          break;\n                        }\n\n                        return _context2.abrupt(\"return\");\n\n                      case 26:\n                        _f = f, _f2 = _slicedToArray(_f, 4), S = _f2[2], b = _f2[3];\n                        return _context2.abrupt(\"return\", [w, S, s, b]);\n\n                      case 28:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2, null, [[4, 10]]);\n              }));\n            }));\n\n          case 20:\n            b = _context3.sent.filter(function (e) {\n              return !!e;\n            });\n\n            if (b.length) {\n              _context3.next = 24;\n              break;\n            }\n\n            _e4 = r.find(function (e) {\n              return w.includes(e);\n            });\n            return _context3.abrupt(\"return\", _e4 ? A(0, \"BLOCKLISTED\", _e4) : A(1, \"FALLBACK\", \"\".concat(w, \" (\").concat(S, \")\")));\n\n          case 24:\n            _b$sort$ = _slicedToArray(b.sort(function (_ref14, _ref15) {\n              var _ref16 = _slicedToArray(_ref14, 1),\n                  _ref16$ = _ref16[0],\n                  e = _ref16$ === void 0 ? Number.MAX_VALUE : _ref16$;\n\n              var _ref17 = _slicedToArray(_ref15, 1),\n                  _ref17$ = _ref17[0],\n                  r = _ref17$ === void 0 ? Number.MAX_VALUE : _ref17$;\n\n              return e - r;\n            })[0], 4), P = _b$sort$[1], C = _b$sort$[2], y = _b$sort$[3];\n\n            if (!(-1 === P)) {\n              _context3.next = 27;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", A(0, \"BLOCKLISTED\", C, P, y));\n\n          case 27:\n            L = h ? i : d;\n            E = 0;\n\n            for (_e5 = 0; _e5 < L.length; _e5++) {\n              P >= L[_e5] && (E = _e5);\n            }\n\n            return _context3.abrupt(\"return\", A(E, \"BENCHMARK\", C, P, y));\n\n          case 31:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n};\n\nexport { l as getGPUTier };","map":null,"metadata":{},"sourceType":"module"}