{"ast":null,"code":"import { Vector3 } from '../math/Vector3.js';\nimport { Quaternion } from '../math/Quaternion.js';\nimport { Clock } from '../core/Clock.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { AudioContext } from './AudioContext.js';\n\nconst _position = /*@__PURE__*/new Vector3();\n\nconst _quaternion = /*@__PURE__*/new Quaternion();\n\nconst _scale = /*@__PURE__*/new Vector3();\n\nconst _orientation = /*@__PURE__*/new Vector3();\n\nclass AudioListener extends Object3D {\n  constructor() {\n    super();\n    this.type = 'AudioListener';\n    this.context = AudioContext.getContext();\n    this.gain = this.context.createGain();\n    this.gain.connect(this.context.destination);\n    this.filter = null;\n    this.timeDelta = 0; // private\n\n    this._clock = new Clock();\n  }\n\n  getInput() {\n    return this.gain;\n  }\n\n  removeFilter() {\n    if (this.filter !== null) {\n      this.gain.disconnect(this.filter);\n      this.filter.disconnect(this.context.destination);\n      this.gain.connect(this.context.destination);\n      this.filter = null;\n    }\n\n    return this;\n  }\n\n  getFilter() {\n    return this.filter;\n  }\n\n  setFilter(value) {\n    if (this.filter !== null) {\n      this.gain.disconnect(this.filter);\n      this.filter.disconnect(this.context.destination);\n    } else {\n      this.gain.disconnect(this.context.destination);\n    }\n\n    this.filter = value;\n    this.gain.connect(this.filter);\n    this.filter.connect(this.context.destination);\n    return this;\n  }\n\n  getMasterVolume() {\n    return this.gain.gain.value;\n  }\n\n  setMasterVolume(value) {\n    this.gain.gain.setTargetAtTime(value, this.context.currentTime, 0.01);\n    return this;\n  }\n\n  updateMatrixWorld(force) {\n    super.updateMatrixWorld(force);\n    const listener = this.context.listener;\n    const up = this.up;\n    this.timeDelta = this._clock.getDelta();\n    this.matrixWorld.decompose(_position, _quaternion, _scale);\n\n    _orientation.set(0, 0, -1).applyQuaternion(_quaternion);\n\n    if (listener.positionX) {\n      // code path for Chrome (see #14393)\n      const endTime = this.context.currentTime + this.timeDelta;\n      listener.positionX.linearRampToValueAtTime(_position.x, endTime);\n      listener.positionY.linearRampToValueAtTime(_position.y, endTime);\n      listener.positionZ.linearRampToValueAtTime(_position.z, endTime);\n      listener.forwardX.linearRampToValueAtTime(_orientation.x, endTime);\n      listener.forwardY.linearRampToValueAtTime(_orientation.y, endTime);\n      listener.forwardZ.linearRampToValueAtTime(_orientation.z, endTime);\n      listener.upX.linearRampToValueAtTime(up.x, endTime);\n      listener.upY.linearRampToValueAtTime(up.y, endTime);\n      listener.upZ.linearRampToValueAtTime(up.z, endTime);\n    } else {\n      listener.setPosition(_position.x, _position.y, _position.z);\n      listener.setOrientation(_orientation.x, _orientation.y, _orientation.z, up.x, up.y, up.z);\n    }\n  }\n\n}\n\nexport { AudioListener };","map":null,"metadata":{},"sourceType":"module"}